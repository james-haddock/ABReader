<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops">
<head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>
<title>Introduction to Algorithms</title>
<link href="css/stylesheet.css" rel="stylesheet" type="text/css"/>
<meta content="urn:uuid:4a9ccac5-f2db-4081-af1f-a5a376b433e1" name="Adept.expected.resource"/>
</head>
<body>
<div class="body"><a id="p1140"/>
<p class="line-c"/>
<section epub:type="backmatter" title="A Summations">
<p class="chapter-title"><a href="toc.xhtml#app-1"><strong><span class="blue1">A Summations</span></strong></a></p>
<p class="noindent">When an algorithm contains an iterative control construct such as a <strong>while</strong> or <strong>for</strong> loop, you can express its running time as the sum of the times spent on each execution of the body of the loop. For example, <a href="chapter002.xhtml#Sec_2.2">Section 2.2</a> argued that the <em>i</em> th iteration of insertion sort took time proportional to <em>i</em> in the worst case. Adding up the time spent on each iteration produced the summation (or series) <img alt="art" src="images/Art_P1525.jpg"/>. Evaluating this summation resulted in a bound of Θ(<em>n</em><sup>2</sup>) on the worst-case running time of the algorithm. This example illustrates why you should know how to manipulate and bound summations.</p>
<p><a href="appendix001.xhtml#Sec_A.1">Section A.1</a> lists several basic formulas involving summations. <a href="appendix001.xhtml#Sec_A.2">Section A.2</a> offers useful techniques for bounding summations. The formulas in <a href="appendix001.xhtml#Sec_A.1">Section A.1</a> appear without proof, though proofs for some of them appear in <a href="appendix001.xhtml#Sec_A.2">Section A.2</a> to illustrate the methods of that section. You can find most of the other proofs in any calculus text.</p>
<p class="line1"/>
<section title="A.1 Summation formulas and properties">
<a id="Sec_A.1"/>
<p class="level1" id="h1-214"><a href="toc.xhtml#Rh1-214"><strong>A.1 Summation formulas and properties</strong></a></p>
<p class="noindent">Given a sequence <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, … , <em>a<sub>n</sub></em> of numbers, where <em>n</em> is a nonnegative integer, the finite sum <em>a</em><sub>1</sub> + <em>a</em><sub>2</sub> + … + <em>a<sub>n</sub></em> can be expressed as <img alt="art" src="images/Art_P1526.jpg"/>. If <em>n</em> = 0, the value of the summation is defined to be 0. The value of a finite series is always well defined, and the order in which its terms are added does not matter.</p>
<p>Given an infinite sequence <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, … of numbers, we can write their infinite sum <em>a</em><sub>1</sub> + <em>a</em><sub>2</sub> + … as <img alt="art" src="images/Art_P1527.jpg"/>, which means <img alt="art" src="images/Art_P1528.jpg"/>. If the limit does not exist, the series <strong><em><span class="blue">diverges</span></em></strong>, and otherwise, it <strong><em><span class="blue">converges</span></em></strong>. The terms of a convergent series cannot always be added in any order. You can, however, rearrange the terms of an <strong><em><span class="blue">absolutely convergent series</span></em></strong>, that is, a series <img alt="art" src="images/Art_P1529.jpg"/> for which the series <img alt="art" src="images/Art_P1530.jpg"/> also converges.</p>
<a id="p1141"/>
<p class="level4"><strong>Linearity</strong></p>
<p class="noindent">For any real number <em>c</em> and any finite sequences <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, … , <em>a<sub>n</sub></em> and <em>b</em><sub>1</sub>, <em>b</em><sub>2</sub>, … , <em>b<sub>n</sub></em>,</p>
<p class="eql"><img alt="art" src="images/Art_P1531.jpg"/></p>
<p class="noindent">The linearity property also applies to infinite convergent series.</p>
<p>The linearity property applies to summations incorporating asymptotic notation. For example,</p>
<p class="eql"><img alt="art" src="images/Art_P1532.jpg"/></p>
<p class="noindent">In this equation, the Θ-notation on the left-hand side applies to the variable <em>k</em>, but on the right-hand side, it applies to <em>n</em>. Such manipulations also apply to infinite convergent series.</p>
<p class="level4"><strong>Arithmetic series</strong></p>
<p class="noindent">The summation</p>
<p class="eql"><img alt="art" src="images/Art_P1533.jpg"/></p>
<p class="noindent">is an <strong><em><span class="blue">arithmetic series</span></em></strong> and has the value</p>
<p class="eqr"><img alt="art" src="images/Art_P1534.jpg"/></p>
<p class="noindent">A <strong><em><span class="blue">general arithmetic series</span></em></strong> includes an additive constant <em>a</em> ≥ 0 and a constant coefficient <em>b</em> &gt; 0 in each term, but has the same total asymptotically:</p>
<p class="eqr"><img alt="art" src="images/Art_P1535.jpg"/></p>
<p class="level4"><strong>Sums of squares and cubes</strong></p>
<p class="noindent">The following formulas apply to summations of squares and cubes:</p>
<p class="eqr"><img alt="art" src="images/Art_P1536.jpg"/></p>
<a id="p1142"/>
<p class="level4"><strong>Geometric series</strong></p>
<p class="noindent">For real <em>x</em> ≠ 1, the summation</p>
<p class="eql"><img alt="art" src="images/Art_P1537.jpg"/></p>
<p class="noindent">is a <strong><em><span class="blue">geometric series</span></em></strong> and has the value</p>
<p class="eqr"><img alt="art" src="images/Art_P1538.jpg"/></p>
<p class="noindent">The infinite decreasing geometric series occurs when the summation is infinite and |<em>x</em>| &lt; 1:</p>
<p class="eqr"><img alt="art" src="images/Art_P1539.jpg"/></p>
<p class="noindent">If we assume that 0<sup>0</sup> = 1, these formulas apply even when <em>x</em> = 0.</p>
<p class="level4"><strong>Harmonic series</strong></p>
<p class="noindent">For positive integers <em>n</em>, the <em>n</em>th <strong><em><span class="blue">harmonic number</span></em></strong> is</p>
<p class="eqr"><img alt="art" src="images/Art_P1540.jpg"/></p>
<p class="noindent">Inequalities (A.20) and (A.21) on page 1150 provide the stronger bounds</p>
<p class="eqr"><img alt="art" src="images/Art_P1541.jpg"/></p>
<p class="level4"><strong>Integrating and differentiating series</strong></p>
<p class="noindent">Integrating or differentiating the formulas above yields additional formulas. For example, differentiating both sides of the infinite geometric series (A.7) and multiplying by <em>x</em> gives</p>
<p class="eqr"><img alt="art" src="images/Art_P1542.jpg"/></p>
<a id="p1143"/>
<p class="level4"><strong>Telescoping series</strong></p>
<p class="noindent">For any sequence <em>a</em><sub>0</sub>, <em>a</em><sub>1</sub>, … , <em>a<sub>n</sub></em>,</p>
<p class="eqr"><img alt="art" src="images/Art_P1543.jpg"/></p>
<p class="noindent">since each of the terms <em>a</em><sub>1</sub>, <em>a</em><sub>2</sub>, … , <em>a</em><sub><em>n</em>−1</sub> is added in exactly once and subtracted out exactly once. We say that the sum <strong><em><span class="blue">telescopes</span></em></strong>. Similarly,</p>
<p class="eql"><img alt="art" src="images/Art_P1544.jpg"/></p>
<p class="noindent">As an example of a telescoping sum, consider the series</p>
<p class="eql"><img alt="art" src="images/Art_P1545.jpg"/></p>
<p class="noindent">Rewriting each term as</p>
<p class="eql"><img alt="art" src="images/Art_P1546.jpg"/></p>
<p class="noindent">gives</p>
<p class="eql"><img alt="art" src="images/Art_P1547.jpg"/></p>
<p class="level4"><strong>Reindexing summations</strong></p>
<p class="noindent">A series can sometimes be simplified by changing its index, often reversing the order of summation. Consider the series <img alt="art" src="images/Art_P1548.jpg"/>. Because the terms in this summation are <em>a<sub>n</sub></em>, <em>a</em><sub><em>n</em>−1</sub>, … , <em>a</em><sub>0</sub>, we can reverse the order of indices by letting <em>j</em> = <em>n</em> − <em>k</em> and rewrite this summation as</p>
<p class="eqr"><img alt="art" src="images/Art_P1549.jpg"/></p>
<p class="noindent">Generally, if the summation index appears in the body of the sum with a minus sign, it’s worth thinking about reindexing.</p>
<p>As an example, consider the summation</p>
<a id="p1144"/>
<p class="eql"><img alt="art" src="images/Art_P1550.jpg"/></p>
<p class="noindent">The index <em>k</em> appears with a negative sign in 1/(<em>n</em> − <em>k</em> + 1). And indeed, we can simplify this summation, this time setting <em>j</em> = <em>n</em> − <em>k</em> + 1, yielding</p>
<p class="eqr"><img alt="art" src="images/Art_P1551.jpg"/></p>
<p class="noindent">which is just the harmonic series (A.8).</p>
<p class="level4"><strong>Products</strong></p>
<p class="noindent">The finite product <em>a</em><sub>1</sub><em>a</em><sub>2</sub> … <em>a<sub>n</sub></em> can be expressed as</p>
<p class="eql"><img alt="art" src="images/Art_P1552.jpg"/></p>
<p class="noindent">If <em>n</em> = 0, the value of the product is defined to be 1. You can convert a formula with a product to a formula with a summation by using the identity</p>
<p class="eql"><img alt="art" src="images/Art_P1553.jpg"/></p>
<p class="exe"><strong>Exercises</strong></p>
<p class="level3"><strong><em>A.1-1</em></strong></p>
<p class="noindent">Prove that <img alt="art" src="images/Art_P1554.jpg"/> by using the linearity property of summations.</p>
<p class="level3"><strong><em>A.1-2</em></strong></p>
<p class="noindent">Find a simple formula for <img alt="art" src="images/Art_P1555.jpg"/>.</p>
<p class="level3"><strong><em>A.1-3</em></strong></p>
<p class="noindent">Interpret the decimal number 111,111,111 in light of equation (A.6).</p>
<p class="level3"><strong><em>A.1-4</em></strong></p>
<p class="noindent">Evaluate the infinite series <img alt="art" src="images/Art_P1556.jpg"/>.</p>
<p class="level3"><strong><em>A.1-5</em></strong></p>
<p class="noindent">Let <em>c</em> ≥ 0 be a constant. Show that <img alt="art" src="images/Art_P1557.jpg"/>.</p>
<p class="level3"><strong><em>A.1-6</em></strong></p>
<p class="noindent">Show that <img alt="art" src="images/Art_P1558.jpg"/> for |<em>x</em>| &lt; 1.</p>
<a id="p1145"/>
<p class="level3"><strong><em>A.1-7</em></strong></p>
<p class="noindent">Prove that <img alt="art" src="images/Art_P1559.jpg"/>. (<em>Hint:</em> Show the asymptotic upper and lower bounds separately.)</p>
<p class="level3"><span class="font1">★</span> <strong><em>A.1-8</em></strong></p>
<p class="noindent">Show that <img alt="art" src="images/Art_P1560.jpg"/> by manipulating the harmonic series.</p>
<p class="level3"><span class="font1">★</span> <strong><em>A.1-9</em></strong></p>
<p class="noindent">Show that <img alt="art" src="images/Art_P1561.jpg"/>.</p>
<p class="level3"><span class="font1">★</span> <strong><em>A.1-10</em></strong></p>
<p class="noindent">Evaluate the sum <img alt="art" src="images/Art_P1562.jpg"/>.</p>
<p class="level3"><span class="font1">★</span> <strong><em>A.1-11</em></strong></p>
<p class="noindent">Evaluate the product <img alt="art" src="images/Art_P1563.jpg"/>.</p>
</section>
<p class="line1"/>
<section title="A.2 Bounding summations">
<a id="Sec_A.2"/>
<p class="level1" id="h1-215"><a href="toc.xhtml#Rh1-215"><strong>A.2 Bounding summations</strong></a></p>
<p class="noindent">You can choose from several techniques to bound the summations that describe the running times of algorithms. Here are some of the most frequently used methods.</p>
<p class="level4"><strong>Mathematical induction</strong></p>
<p class="noindent">The most basic way to evaluate a series is to use mathematical induction. As an example, let’s prove that the arithmetic series <img alt="art" src="images/Art_P1564.jpg"/> evaluates to <em>n</em>(<em>n</em> + 1)/2. For <em>n</em> = 1, we have that <em>n</em>(<em>n</em> + 1)/2 = 1 · 2/2 = 1, which equals <img alt="art" src="images/Art_P1565.jpg"/>. With the inductive assumption that it holds for <em>n</em>, we prove that it holds for <em>n</em> + 1. We have</p>
<p class="eql"><img alt="art" src="images/Art_P1566.jpg"/></p>
<p>You don’t always need to guess the exact value of a summation in order to use mathematical induction. Instead, you can use induction to prove an upper or lower <a id="p1146"/>bound on a summation. As an example, let’s prove the asymptotic upper bound <img alt="art" src="images/Art_P1567.jpg"/>. More specifically, we’ll prove that <img alt="art" src="images/Art_P1568.jpg"/> for some constant <em>c</em>. For the initial condition <em>n</em> = 0, we have <img alt="art" src="images/Art_P1569.jpg"/> as long as <em>c</em> ≥ 1. Assuming that the bound holds for <em>n</em>, we prove that it holds for <em>n</em> + 1. We have</p>
<p class="eql"><img alt="art" src="images/Art_P1570.jpg"/></p>
<p class="noindent">as long as (1/3 + 1/<em>c</em>) ≤ 1 or, equivalently, <em>c</em> ≥ 3/2. Thus, <img alt="art" src="images/Art_P1571.jpg"/>, as we wished to show.</p>
<p>You need to take care when using asymptotic notation to prove bounds by induction. Consider the following fallacious proof that <img alt="art" src="images/Art_P1572.jpg"/>. Certainly, <img alt="art" src="images/Art_P1573.jpg"/>. Assuming that the bound holds for <em>n</em>, we now prove it for <em>n</em> + 1:</p>
<p class="eql"><img alt="art" src="images/Art_P1574.jpg"/></p>
<p class="noindent">The bug in the argument is that the “constant” hidden by the “big-oh” grows with <em>n</em> and thus is not constant. We have not shown that the same constant works for <em>all n</em>.</p>
<p class="level4"><strong>Bounding the terms</strong></p>
<p class="noindent">You can sometimes obtain a good upper bound on a series by bounding each term of the series, and it often suffices to use the largest term to bound the others. For example, a quick upper bound on the arithmetic series (A.1) is</p>
<p class="eql"><img alt="art" src="images/Art_P1575.jpg"/></p>
<p class="noindent">In general, for a series <img alt="art" src="images/Art_P1576.jpg"/>, if we let <em>a</em><sub>max</sub> = max {<em>a<sub>k</sub></em> : 1 ≤ <em>k</em> ≤ <em>n</em>}, then</p>
<p class="eql"><img alt="art" src="images/Art_P1578.jpg"/></p>
<a id="p1147"/>
<p>The technique of bounding each term in a series by the largest term is a weak method when the series can in fact be bounded by a geometric series. Given the series <img alt="art" src="images/Art_P1579.jpg"/>, suppose that <em>a</em><sub><em>k</em>+1</sub>/<em>a<sub>k</sub></em> ≤ <em>r</em> for all <em>k</em> ≥ 0, where 0 &lt; <em>r</em> &lt; 1 is a constant. You can bound the sum by an infinite decreasing geometric series, since <em>a</em><sub><em>k</em></sub> ≤ <em>a</em><sub>0</sub><em>r<sup>k</sup></em>, and thus</p>
<p class="eqr"><img alt="art" src="images/Art_P1580.jpg"/></p>
<p>You can apply this method to bound the summation <img alt="art" src="images/Art_P1581.jpg"/>. In order to start the summation at <em>k</em> = 0, rewrite it as <img alt="art" src="images/Art_P1582.jpg"/>. The first term (<em>a</em><sub>0</sub>) is 1/3, and the ratio (<em>r</em>) of consecutive terms is</p>
<p class="eql"><img alt="art" src="images/Art_P1583.jpg"/></p>
<p class="noindent">for all <em>k</em> ≥ 0. Thus, we have</p>
<p class="eql"><img alt="art" src="images/Art_P1584.jpg"/></p>
<p>A common bug in applying this method is to show that the ratio of consecutive terms is less than 1 and then to assume that the summation is bounded by a geometric series. An example is the infinite harmonic series, which diverges since</p>
<p class="eql"><img alt="art" src="images/Art_P1585.jpg"/></p>
<p class="noindent">The ratio of the (<em>k</em>+1)st and <em>k</em>th terms in this series is <em>k</em>/(<em>k</em>+1) &lt; 1, but the series is not bounded by a decreasing geometric series. To bound a series by a geometric <a id="p1148"/>series, you need to show that there is an <em>r</em> &lt; 1, which is a <em>constant</em>, such that the ratio of all pairs of consecutive terms never exceeds <em>r</em>. In the harmonic series, no such <em>r</em> exists because the ratio becomes arbitrarily close to 1.</p>
<p class="level4"><strong>Splitting summations</strong></p>
<p class="noindent">One way to obtain bounds on a difficult summation is to express the series as the sum of two or more series by partitioning the range of the index and then to bound each of the resulting series. For example, let’s find a lower bound on the arithmetic series <img alt="art" src="images/Art_P1586.jpg"/>, which we have already seen has an upper bound of <em>n</em><sup>2</sup>. You might attempt to bound each term in the summation by the smallest term, but since that term is 1, you would get a lower bound of <em>n</em> for the summation—far off from the upper bound of <em>n</em><sup>2</sup>.</p>
<p>You can obtain a better lower bound by first splitting the summation. Assume for convenience that <em>n</em> is even, so that</p>
<p class="eql"><img alt="art" src="images/Art_P1587.jpg"/></p>
<p class="noindent">which is an asymptotically tight bound, since <img alt="art" src="images/Art_P1588.jpg"/>.</p>
<p>For a summation arising from the analysis of an algorithm, you can sometimes split the summation and ignore a constant number of the initial terms. Generally, this technique applies when each term <em>a<sub>k</sub></em> in a summation <img alt="art" src="images/Art_P1589.jpg"/> is independent of <em>n</em>. Then for any constant <em>k</em><sub>0</sub> &gt; 0, you can write</p>
<p class="eql"><img alt="art" src="images/Art_P1590.jpg"/></p>
<p class="noindent">since the initial terms of the summation are all constant and there are a constant number of them. You can then use other methods to bound <img alt="art" src="images/Art_P1591.jpg"/>. This technique applies to infinite summations as well. For example, let’s find an asymptotic upper bound on <img alt="art" src="images/Art_P1592.jpg"/>. The ratio of consecutive terms is</p>
<a id="p1149"/>
<p class="eql"><img alt="art" src="images/Art_P1593.jpg"/></p>
<p class="noindent">if <em>k</em> ≥ 3. Thus, you can split the summation into</p>
<p class="eql"><img alt="art" src="images/Art_P1594.jpg"/></p>
<p>The technique of splitting summations can help determine asymptotic bounds in much more difficult situations. For example, here is one way to obtain a bound of <em>O</em>(lg <em>n</em>) on the harmonic series (A.9):</p>
<p class="eql"><img alt="art" src="images/Art_P1595.jpg"/></p>
<p class="noindent">The idea is to split the range 1 to <em>n</em> into <span class="font1">⌊</span>lg <em>n</em><span class="font1">⌋</span> + 1 pieces and upper-bound the contribution of each piece by 1. For <em>i</em> = 0, 1, … , <span class="font1">⌊</span>lg <em>n</em><span class="font1">⌋</span>, the <em>i</em>th piece consists of the terms starting at 1/2<sup><em>i</em></sup> and going up to but not including 1/2<sup><em>i</em>+1</sup>. The last piece might contain terms not in the original harmonic series, giving</p>
<p class="eqr"><img alt="art" src="images/Art_P1596.jpg"/></p>
<a id="p1150"/>
<p class="level4"><strong>Approximation by integrals</strong></p>
<p class="noindent">When a summation has the form <img alt="art" src="images/Art_P1597.jpg"/>, where <em>f</em> (<em>k</em>) is a monotonically increasing function, you can approximate it by integrals:</p>
<p class="eqr"><img alt="art" src="images/Art_P1598.jpg"/></p>
<p class="noindent"><a href="#Fig_A-1">Figure A.1</a> justifies this approximation. The summation is represented as the area of the rectangles in the figure, and the integral is the blue region under the curve. When <em>f</em> (<em>k</em>) is a monotonically decreasing function, you can use a similar method to provide the bounds</p>
<p class="eqr"><img alt="art" src="images/Art_P1599.jpg"/></p>
<p>The integral approximation (A.19) can be used to prove the tight bounds in inequality (A.10) for the <em>n</em>th harmonic number. The lower bound is</p>
<p class="eqr"><img alt="art" src="images/Art_P1600.jpg"/></p>
<p class="noindent">For the upper bound, the integral approximation gives</p>
<p class="eqr"><img alt="art" src="images/Art_P1601.jpg"/></p>
<p class="exe"><strong>Exercises</strong></p>
<p class="level3"><strong><em>A.2-1</em></strong></p>
<p class="noindent">Show that <img alt="art" src="images/Art_P1602.jpg"/> is bounded above by a constant.</p>
<p class="level3"><strong><em>A.2-2</em></strong></p>
<p class="noindent">Find an asymptotic upper bound on the summation</p>
<p class="eql"><img alt="art" src="images/Art_P1603.jpg"/></p>
<a id="p1151"/>
<div class="divimage">
<p class="fig-imga" id="Fig_A-1"><img alt="art" src="images/Art_P1604.jpg"/></p>
<p class="caption"><strong>Figure A.1</strong> Approximation of <img alt="art" src="images/Art_P1605.jpg"/> by integrals. The area of each rectangle is shown within the rectangle, and the total rectangle area represents the value of the summation. The integral is represented by the blue area under the curve. Comparing areas in <strong>(a)</strong> gives the lower bound <img alt="art" src="images/Art_P1606.jpg"/>. Shifting the rectangles one unit to the right gives the upper bound <img alt="art" src="images/Art_P1607.jpg"/> in <strong>(b)</strong>.</p>
</div>
<a id="p1152"/>
<p class="level3"><strong><em>A.2-3</em></strong></p>
<p class="noindent">Show that the <em>n</em>th harmonic number is Ω(lg <em>n</em>) by splitting the summation.</p>
<p class="level3"><strong><em>A.2-4</em></strong></p>
<p class="noindent">Approximate <img alt="art" src="images/Art_P1608.jpg"/> with an integral.</p>
<p class="level3"><strong><em>A.2-5</em></strong></p>
<p class="noindent">Why can’t you use the integral approximation (A.19) directly on <img alt="art" src="images/Art_P1609.jpg"/> to obtain an upper bound on the <em>n</em>th harmonic number?</p>
</section>
<p class="line1"/>
<section title="Problems">
<p class="level1" id="h1-216"><strong>Problems</strong></p>
<section title="A-1 Bounding summations">
<p class="level2"><strong><em>A-1 Bounding summations</em></strong></p>
<p class="noindent">Give asymptotically tight bounds on the following summations. Assume that <em>r</em> ≥ 0 and <em>s</em> ≥ 0 are constants.</p>
<p class="nl-1list-d"><strong><em>a.</em></strong> <img alt="art" src="images/Art_P1610.jpg"/></p>
<p class="nl-1list-d"><strong><em>b.</em></strong> <img alt="art" src="images/Art_P1611.jpg"/></p>
<p class="nl-1list-d"><strong><em>c.</em></strong> <img alt="art" src="images/Art_P1612.jpg"/></p>
</section>
</section>
<p class="line1"/>
<section title="Appendix notes">
<p class="level1" id="h1-217"><strong>Appendix notes</strong></p>
<p class="noindent">Knuth [<a epub:type="noteref" href="bibliography001.xhtml#endnote_259">259</a>] provides an excellent reference for the material presented here. You can find basic properties of series in any good calculus book, such as Apostol [<a epub:type="noteref" href="bibliography001.xhtml#endnote_19">19</a>] or Thomas et al. [<a epub:type="noteref" href="bibliography001.xhtml#endnote_433">433</a>].</p>
</section>
</section>
</div>
</body>
</html>